import{_ as K}from"./no-data-d6f55554.js";import{d as J}from"./dayjs.min-ac6c82aa.js";import{e as Z}from"./exceljs.min-3890d7de.js";import{q as ee,r as d,p as W,g as n,d as p,e as g,f as t,t as m,i as A,o as G,b as P,j as L,F as V,l as N,J as q,h as T,m as h,n as B,s as U,_ as te,k as j,E as ne,G as oe}from"./app-e1ab7da0.js";import{L as ae}from"./LoadingSpinner-1df67a25.js";import{S as se}from"./Service-a2d19084.js";import"./_commonjs-dynamic-modules-302442b1.js";/* empty css                                                                       */const le="/build/assets/present-img-ae7c8f7a.png",ie="/build/assets/Absent-6ed9e5f4.png",re="/build/assets/Leave-4ca0d5f0.png",ce="/build/assets/Early_going-6bfb3337.png",de="/build/assets/Late_coming-52c4aae0.png",Q="/build/assets/MIP_MOP-c9ad109b.png",F=ee("useAttendanceDashboardMainStore",()=>{const x=d(!1);d();const e=d(),b=d(),i=d(!1),v=d(!1),S=d(),c=d([]),w=d(),_=d(),o=d([]),a=d([]),r=d(),s=d([]),l=d(),y=d(),D=d([]),u=d(),f=d([{label:"Absent",backgroundColor:"#FFB1B8",count:null},{label:"Present",backgroundColor:"#7A5EA2",count:null},{label:"Leave",backgroundColor:"#8D98B5",count:null},{label:"Late coming",backgroundColor:"#D9AA63",count:null},{label:"Early going",backgroundColor:"#6BB7C0",count:null},{label:"Missed out punch",backgroundColor:"#000000",count:null},{label:"Missed in punch",backgroundColor:"#000000",count:null}]);function $(){W.get("/fetch-departments").then(M=>{u.value=M.data,console.log(M.data)}).finally(()=>{})}function O(M,E){x.value=!0,W.post("/get-attendance-dashboard",{department_id:M,date:E||new Date}).then(R=>{e.value=R.data.attendance_overview,l.value=R.data.total_Employees,console.log(" totalEmployeeInOrganization.value"+l.value),f.value[0].count=parseInt(e.value.absent_count),f.value[1].count=parseInt(e.value.present_count),f.value[2].count=parseInt(e.value.leave_emp_count),f.value[3].count=parseInt(e.value.lc_count),f.value[4].count=parseInt(e.value.eg_count),f.value[5].count=parseInt(e.value.mop_count),f.value[6].count=parseInt(e.value.mip_count),b.value=R.data.work_shift;let Y=Object.entries(R.data.upcomings).map(C=>({title:C[0],value:C[1]}));_.value=Y;let z=Object.entries(R.data.attendance_overview).map(C=>({title:C[0],value:C[1]}));r.value=z;let k=["absent_count","present_count","leave_emp_count","lc_count","eg_count","mop_count","mip_count"];r.value.forEach(async C=>{s.value.length<7&&k.includes(C.title)&&s.value.push(C.value)}),y.value=R.data.CheckInMode,y.value.forEach(async C=>{D.value.length<3&&D.value.push(C.value)})}).finally(()=>{x.value=!1})}return{canShowLoading:x,attendanceDashboardWorkShiftSource:b,getAttendanceDashboardMainSource:async()=>{x.value=!0;let M="/get-attendance-dashboard";await W.post(M,{date:J(new Date).format("YYYY-MM-DD")}).then(E=>{e.value=E.data.attendance_overview,l.value=E.data.total_Employees,console.log(" totalEmployeeInOrganization.value"+l.value),f.value[0].count=parseInt(e.value.absent_count),f.value[1].count=parseInt(e.value.present_count),f.value[2].count=parseInt(e.value.leave_emp_count),f.value[3].count=parseInt(e.value.lc_count),f.value[4].count=parseInt(e.value.eg_count),f.value[5].count=parseInt(e.value.mop_count),f.value[6].count=parseInt(e.value.mip_count),b.value=E.data.work_shift;let R=Object.entries(E.data.upcomings).map(k=>({title:k[0],value:k[1]}));_.value=R;let Y=Object.entries(E.data.attendance_overview).map(k=>({title:k[0],value:k[1]}));r.value=Y;let z=["absent_count","present_count","leave_emp_count","lc_count","eg_count","mop_count","mip_count"];r.value.forEach(async k=>{s.value.length<7&&z.includes(k.title)&&s.value.push(k.value)}),y.value=E.data.CheckInMode,y.value.forEach(async k=>{D.value.length<3&&D.value.push(k.value)})}).finally(()=>{x.value=!1})},attendanceOverview:e,totalEmployeeInOrganization:l,chartDetails:f,canShowShiftDetails:i,canShowAttendanceOverview:v,selectedAttendanceOverviewReport:S,currentlySelectedShiftDetails:c,currentlySelectedShiftName:w,downloadShiftDetails:o,downloadAttendanceOverviewDetails:a,attendanceDashboardUpcoming:_,overallEmployeeCountForExceptionAnalytics:r,overallEmployeeCountForExceptionAnalyticsForGraph:s,AttendanceAnalytics:y,AttendanceAnalyticsForGraph:D,GetDepartment:$,departments:u,send_selectedDepartment:O}}),ue={key:0,class:"grid grid-cols-7 gap-4"},pe={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},ve={class:"mr-2 text-3xl font-semibold text-center"},_e=t("img",{class:"right-8 w-[16px] h-[16px]",src:le,alt:""},null,-1),me=t("p",{class:"text-lg text-center text-blue-500 font-[Poppins] font-medium mt-[10px]"},"Present",-1),he={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},fe={class:"text-3xl font-semibold text-center"},ge=t("img",{class:"ml-6 w-[20px] h-[20px]",src:ie,alt:""},null,-1),be=t("p",{class:"text-lg text-center text-blue-500 font-[Poppins] font-medium mt-[10px]"},"Absent",-1),xe={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},we={class:"text-3xl font-semibold text-center"},ye=t("img",{src:re,alt:"",class:"ml-6 w-[20px] h-[20px]"},null,-1),Se=t("p",{class:"text-lg text-center text-blue-500 font-[Poppins] font-medium mt-[10px]"},"Leave",-1),Ae={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},De={class:"text-3xl font-semibold text-center"},ke=t("img",{src:ce,class:"ml-6 w-[20px] h-[20px]",alt:""},null,-1),$e=t("p",{class:"text-lg font-semibold text-center text-blue-500 mt-[10px]"},"Late Coming",-1),Oe={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},Ce={class:"text-3xl font-semibold text-center"},Ee=t("img",{src:de,class:"ml-6 w-[20px] h-[20px]",alt:""},null,-1),Le=t("p",{class:"text-lg font-semibold text-center text-blue-500 mt-[10px]"},"Early Going",-1),Me={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},Re={class:"text-3xl font-semibold text-center"},je=t("img",{src:Q,class:"ml-6 w-[20px] h-[20px]",alt:""},null,-1),Pe=t("p",{class:"text-lg font-semibold text-center text-blue-500 mt-[10px]"},"Missed in Punch",-1),Be={class:"px-auto mx-auto flex justify-around items-center w-[86px]"},Fe={class:"text-3xl font-semibold text-center"},Ie=t("img",{src:Q,class:"ml-6 w-[20px] h-[20px]",alt:""},null,-1),Ue=t("p",{class:"text-lg font-semibold text-center text-blue-500 mt-[10px]"},"Missed out Punch",-1),Te={__name:"attendanceCount",setup(x){d();const e=F();return(b,i)=>n(e).attendanceOverview?(p(),g("div",ue,[t("div",{class:"relative bg-white rounded-lg py-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:i[0]||(i[0]=v=>(n(e).selectedAttendanceOverviewReport="Present",n(e).canShowAttendanceOverview=!0,n(e).currentlySelectedShiftDetails={...n(e).attendanceOverview.present_emps},n(e).downloadAttendanceOverviewDetails.push({...n(e).attendanceOverview.present_emps})))},[t("div",pe,[t("span",ve,m(n(e).attendanceOverview.present_count),1),_e]),me]),t("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:i[1]||(i[1]=v=>(n(e).selectedAttendanceOverviewReport="Absent",n(e).canShowAttendanceOverview=!0,n(e).currentlySelectedShiftDetails={...n(e).attendanceOverview.absent_emps},n(e).downloadAttendanceOverviewDetails.push({...n(e).attendanceOverview.absent_emps})))},[t("div",he,[t("span",fe,m(n(e).attendanceOverview.absent_count),1),ge]),be]),t("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:i[2]||(i[2]=v=>(n(e).selectedAttendanceOverviewReport="Leave",n(e).canShowAttendanceOverview=!0,n(e).currentlySelectedShiftDetails={...n(e).attendanceOverview.leave_emps},n(e).downloadAttendanceOverviewDetails.push({...n(e).attendanceOverview.leave_emps})))},[t("div",xe,[t("span",we,m(n(e).attendanceOverview.leave_emp_count),1),ye]),Se]),t("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:i[3]||(i[3]=v=>(n(e).selectedAttendanceOverviewReport="Late coming",n(e).canShowAttendanceOverview=!0,n(e).currentlySelectedShiftDetails={...n(e).attendanceOverview.lc_emps},n(e).downloadAttendanceOverviewDetails.push({...n(e).attendanceOverview.lc_emps})))},[t("div",Ae,[t("span",De,m(n(e).attendanceOverview.lc_count),1),ke]),$e]),t("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:i[4]||(i[4]=v=>(n(e).selectedAttendanceOverviewReport="Early going",n(e).canShowAttendanceOverview=!0,n(e).currentlySelectedShiftDetails={...n(e).attendanceOverview.eg_emps},n(e).downloadAttendanceOverviewDetails.push({...n(e).attendanceOverview.eg_emps})))},[t("div",Oe,[t("span",Ce,m(n(e).attendanceOverview.eg_count),1),Ee]),Le]),t("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:i[5]||(i[5]=v=>(n(e).selectedAttendanceOverviewReport="Missed in punch",n(e).canShowAttendanceOverview=!0,n(e).currentlySelectedShiftDetails={...n(e).attendanceOverview.mip_emps},n(e).downloadAttendanceOverviewDetails.push({...n(e).attendanceOverview.mip_emps})))},[t("div",Me,[t("span",Re,m(n(e).attendanceOverview.mip_count),1),je]),Pe]),t("div",{class:"bg-white rounded-lg p-2 border cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100",onClick:i[6]||(i[6]=v=>(n(e).selectedAttendanceOverviewReport="Missed out punch",n(e).canShowAttendanceOverview=!0,n(e).currentlySelectedShiftDetails={...n(e).attendanceOverview.mop_emps},n(e).downloadAttendanceOverviewDetails.push({...n(e).attendanceOverview.mop_emps})))},[t("div",Be,[t("span",Fe,m(n(e).attendanceOverview.mop_count),1),Ie]),Ue])])):A("",!0)}},Ve={key:0,class:"bg-white rounded-lg p-2 border"},Ge=t("p",{class:"font-semibold text-[14px] text-[#000] font-['Poppins] text-center"},"Attendance Analytics",-1),Ne={class:"grid grid-cols-2 gap-4 my-2.5"},He={class:"h-full"},Ye={class:"flex items-center"},ze={class:""},We={class:"flex items-center gap-3"},Je={class:"font-semibold text-lg"},qe={__name:"exceptionAnalytics",setup(x){const e=F();G(()=>{i.value=v(),setTimeout(()=>{console.log(e.overallEmployeeCountForExceptionAnalyticsForGraph),b.value.datasets[0].data=e.overallEmployeeCountForExceptionAnalyticsForGraph},15e3)}),d([]);const b=d({labels:["Absent","Present","Leave","Late coming","Early going","Missed out punch","Missed in punch"],datasets:[{backgroundColor:["#FFB1B8","#7A5EA2","#8D98B5","#D9AA63","#6BB7C0","#000000","#000000"],data:[0,0,0,0,0,0,0]}]}),i=d();d();const v=()=>{const c=getComputedStyle(document.documentElement),w=c.getPropertyValue("--text-color");return c.getPropertyValue("--text-color-secondary"),c.getPropertyValue("--surface-border"),{maintainAspectRatio:!1,aspectRatio:1,plugins:{labels:{usePointStyle:!0},title:{display:!1,text:"Custom Chart Title"},legend:{display:!1,labels:{fontColor:w}}}}},S=(c,w)=>`${(c/w*100).toFixed(0)}`;return(c,w)=>{const _=P("Chart");return n(e).chartDetails?(p(),g("div",Ve,[Ge,t("div",Ne,[t("div",He,[n(e).overallEmployeeCountForExceptionAnalyticsForGraph?(p(),L(_,{key:0,type:"pie",data:b.value,options:i.value,class:"h-full"},null,8,["data","options"])):A("",!0)]),t("div",Ye,[t("div",ze,[t("div",null,[(p(!0),g(V,null,N(n(e).chartDetails,(o,a)=>(p(),g("div",We,[t("div",{style:q({backgroundColor:o.backgroundColor}),class:"rounded-lg h-2 w-2 p-1.5"},null,4),t("div",null,[T(m(o.label)+" - ",1),t("span",Je,m(S(o.count,n(e).totalEmployeeInOrganization)),1),T("% ")])]))),256))])])])])])):A("",!0)}}};const Xe={key:0,class:"bg-white rounded-lg p-2 h-[100%]"},Ke=t("p",{class:"font-semibold text-[14px] text-[#000] font-['Poppins] text-center"},"Check-In & Out Analytics ",-1),Qe={class:"grid grid-cols-2 gap-4 my-2.5"},Ze={class:"h-full"},et={class:"flex items-center"},tt={class:"my-auto"},nt={class:"flex items-center gap-3"},ot={class:"font-semibold text-lg"},at=t("div",null,null,-1),st={__name:"attendanceAnalytics",setup(x){const e=F();G(()=>{i.value=v(),setTimeout(()=>{b.value.datasets[0].data=e.AttendanceAnalyticsForGraph},3e3)});const b=d({labels:["Bio-Metric","Mobile","Web"],datasets:[{data:[0,0,0],backgroundColor:["rgba(122, 94, 162, 1)","rgba(255, 177, 184, 1)","rgba(107, 183, 192, 1)"]}]}),i=d();d(0),d([{label:"Bio-Metric",backgroundColor:"rgba(122, 94, 162, 1)"},{label:"Mobile",backgroundColor:"rgba(255, 177, 184, 1)"},{label:"Web",backgroundColor:"rgba(107, 183, 192, 1)"}]);const v=()=>{const c=getComputedStyle(document.documentElement),w=c.getPropertyValue("--text-color");return c.getPropertyValue("--text-color-secondary"),c.getPropertyValue("--surface-border"),{maintainAspectRatio:!1,aspectRatio:1,plugins:{labels:{usePointStyle:!0},title:{display:!1,text:"Custom Chart Title"},legend:{display:!1,labels:{fontColor:w}}}}},S=(c,w)=>`${(c/w*100).toFixed(0)}`;return(c,w)=>{const _=P("Chart");return n(e).AttendanceAnalytics?(p(),g("div",Xe,[Ke,t("div",Qe,[t("div",Ze,[h(_,{type:"doughnut",data:b.value,options:i.value},null,8,["data","options"])]),t("div",et,[t("div",tt,[t("div",null,[(p(!0),g(V,null,N(n(e).AttendanceAnalytics,(o,a)=>(p(),g("div",nt,[t("div",{style:q({backgroundColor:b.value.datasets[0].backgroundColor[a]}),class:"rounded-lg h-2 w-2 p-1.5"},null,4),t("div",null,[T(m(o.title)+" - ",1),t("span",ot,m(S(o.value,n(e).totalEmployeeInOrganization)),1),T("% ")])]))),256))]),at])])])])):A("",!0)}}},lt={class:"bg-[#E4ECFF] h-full rounded-lg p-3"},it=t("div",{class:"mx-4 flex items-center justify-between"},[t("span",{class:"font-semibold text-[14px] text-[#000] font-['Poppins]"},"Upcomings"),t("i",{class:"pi pi-calendar text-[#000] text-[16px]"})],-1),rt={class:"overflow-x-scroll bg-[#E4ECFF] rounded-lg"},ct={class:"px-auto"},dt={class:"p-2 my-2 transition duration-700 ease-in-out bg-white rounded-lg cursor-pointer hover:-translate-y-1 hover:scale-100"},ut={class:"flex px-2 justify-between items-center"},pt={class:"text-[14px] font-semibold"},vt={class:"flex items-center gap-6"},_t={class:"text-xl font-semibold text-black"},mt=t("span",null,[t("i",{class:"fa fa-chevron-right","aria-hidden":"true"})],-1),ht={key:1,class:"font-medium text-sm text-center"},ft={__name:"Upcomings",setup(x){const e=F();return(b,i)=>(p(),g("div",lt,[it,t("div",rt,[n(e).attendanceDashboardUpcoming?(p(!0),g(V,{key:0},N(n(e).attendanceDashboardUpcoming,v=>(p(),g("div",ct,[t("div",dt,[t("div",ut,[t("div",null,[t("span",pt,m(v.title),1)]),t("div",vt,[t("span",_t,m(v.value),1),mt])])])]))),256)):(p(),g("p",ht,"No data to display"))])]))}},gt={key:0,class:"bg-white p-2 rounded-[6px] border"},bt=t("span",{class:"font-semibold text-[#000] font-['Poppins] text-[16px]"},"Shift",-1),xt={class:"grid grid-cols-6 gap-2"},wt=["onClick"],yt={class:"p-3"},St=t("p",{class:"font-semibold text-sm text-[#000] font-['Poppins]"},"Shift Timing",-1),At={key:0,class:"font-medium text-[12px] text-gray-600 font-['Poppins]"},Dt={class:"my-3"},kt=t("p",{class:"font-semibold text-sm text-[#000] font-['Poppins]"},"Total Employees",-1),$t={class:"font-medium text-[12px] text-gray-600 font-['Poppins]"},Ot={class:"flex justify-between"},Ct=t("p",{class:"font-semibold text-sm text-[#000] font-['Poppins]"},"Present",-1),Et={class:"font-medium text-[12px] text-gray-600 font-['Poppins]"},Lt={class:"mx-3"},Mt=t("p",{class:"font-semibold text-sm text-[#000] font-['Poppins]"},"Absent",-1),Rt={class:"font-medium text-[12px] text-gray-600 font-['Poppins]"},jt={__name:"Shifts",setup(x){const e=F();function b(o){const[a,r]=o.split(":").map(Number),s=a>=12?"PM":"AM";return`${a%12===0?12:a%12}:${String(r).padStart(2,"0")} ${s}`}const i=["bg-orange-100","bg-red-100","bg-orange-100","bg-gray-100","bg-emerald-100","bg-orange-100","bg-red-100","bg-orange-100","bg-gray-100","bg-black-100"],v=o=>i[o],S=["bg-orange-50","bg-red-50","bg-orange-50","bg-gray-50","bg-emerald-50","bg-orange-50","bg-red-50","bg-orange-50","bg-gray-50","bg-black-50"],c=o=>S[o],w=["text-[#000]","text-[#000]","text-[#000]","text-[#000]","text-[#000]","text-[#000]"],_=o=>w[o];return(o,a)=>n(e).attendanceDashboardWorkShiftSource?(p(),g("div",gt,[bt,t("div",xt,[(p(!0),g(V,null,N(n(e).attendanceDashboardWorkShiftSource,(r,s)=>(p(),g("div",{class:B([c(s),"h-[200px] mx-[10px] rounded-[6px] cursor-pointer transition duration-700 ease-in-out hover:-translate-y-1 hover:scale-100"]),onClick:l=>(n(e).canShowShiftDetails=!0,n(e).currentlySelectedShiftDetails={...r.work_shift_employee_data},n(e).downloadShiftDetails.push({...r.work_shift_employee_data})),key:s},[t("div",{class:B(["w-full rounded-t-[8px] pl-[12px] py-2",v(s)])},[t("span",{class:B(["font-semibold text-[16px] font-['Poppins]",_(s)])},m(r.work_shift_employee_data[0]?r.work_shift_employee_data[0].shift_name:""),3)],2),t("div",yt,[t("div",null,[St,r.work_shift_employee_data[0]?(p(),g("p",At,m(b(r.work_shift_employee_data[0].shift_start_time))+" - "+m(b(r.work_shift_employee_data[0].shift_end_time)),1)):A("",!0)]),t("div",Dt,[kt,t("p",$t,m(r.work_shift_assigned_employees?r.work_shift_assigned_employees:"-"),1)]),t("div",Ot,[t("div",null,[Ct,t("p",Et,m(r.present_count?r.present_count:0),1)]),t("div",Lt,[Mt,t("p",Rt,m(r.absent_count?r.absent_count:0),1)])])])],10,wt))),128))])])):A("",!0)}};var X={},Pt={get exports(){return X},set exports(x){X=x}};(function(x,e){(function(b,i){i()})(U,function(){function b(o,a){return typeof a>"u"?a={autoBom:!1}:typeof a!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function i(o,a,r){var s=new XMLHttpRequest;s.open("GET",o),s.responseType="blob",s.onload=function(){_(s.response,a,r)},s.onerror=function(){console.error("could not download file")},s.send()}function v(o){var a=new XMLHttpRequest;a.open("HEAD",o,!1);try{a.send()}catch{}return 200<=a.status&&299>=a.status}function S(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(a)}}var c=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof U=="object"&&U.global===U?U:void 0,w=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),_=c.saveAs||(typeof window!="object"||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!w?function(o,a,r){var s=c.URL||c.webkitURL,l=document.createElement("a");a=a||o.name||"download",l.download=a,l.rel="noopener",typeof o=="string"?(l.href=o,l.origin===location.origin?S(l):v(l.href)?i(o,a,r):S(l,l.target="_blank")):(l.href=s.createObjectURL(o),setTimeout(function(){s.revokeObjectURL(l.href)},4e4),setTimeout(function(){S(l)},0))}:"msSaveOrOpenBlob"in navigator?function(o,a,r){if(a=a||o.name||"download",typeof o!="string")navigator.msSaveOrOpenBlob(b(o,r),a);else if(v(o))i(o,a,r);else{var s=document.createElement("a");s.href=o,s.target="_blank",setTimeout(function(){S(s)})}}:function(o,a,r,s){if(s=s||open("","_blank"),s&&(s.document.title=s.document.body.innerText="downloading..."),typeof o=="string")return i(o,a,r);var l=o.type==="application/octet-stream",y=/constructor/i.test(c.HTMLElement)||c.safari,D=/CriOS\/[\d]+/.test(navigator.userAgent);if((D||l&&y||w)&&typeof FileReader<"u"){var u=new FileReader;u.onloadend=function(){var O=u.result;O=D?O:O.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=O:location=O,s=null},u.readAsDataURL(o)}else{var f=c.URL||c.webkitURL,$=f.createObjectURL(o);s?s.location=$:location.href=$,s=null,setTimeout(function(){f.revokeObjectURL($)},4e4)}});c.saveAs=_.saveAs=_,x.exports=_})})(Pt);const I=x=>(ne("data-v-eb7d401e"),x=x(),oe(),x),Bt={class:"w-full"},Ft=I(()=>t("p",{class:"mb-2 text-2xl font-semibold text-black"}," Attendance Dashboard ",-1)),It={class:"flex justify-between items-center p-2 bg-white border rounded-lg"},Ut={class:"mx-2"},Tt={class:"font-[14px] font-['Poppins'] text-gray-500"},Vt={class:"mb-2 text-sm font-semibold"},Gt={class:"flex items-center justify-end gap-3 mx-4"},Nt={class:"flex justify-center items-center w-[100%]"},Ht=I(()=>t("i",{class:"pi pi-times"},null,-1)),Yt=[Ht],zt={class:"my-3"},Wt={class:"grid grid-cols-3 gap-2"},Jt={class:"my-3"},qt={class:"bg-[#000] text-[#fff] w-[100%] h-[60px] absolute top-0 left-0"},Xt={class:"m-4 text-[#ffff] font-['poppins] font-semibold relative"},Kt={class:"relative right-0 mx-4 font-semibold fs-5"},Qt=I(()=>t("p",{class:"relative left-2 font-['poppins']"},"Download",-1)),Zt=I(()=>t("svg",{width:"22px",height:"16px",viewBox:"0 0 22 16"},[t("path",{d:"M2,10 L6,13 L12.8760559,4.5959317 C14.1180021,3.0779974 16.2457925,2.62289624 18,3.5 L18,3.5 C19.8385982,4.4192991 21,6.29848669 21,8.35410197 L21,10 C21,12.7614237 18.7614237,15 16,15 L1,15",id:"check"}),t("polyline",{points:"4.5 8.5 8 11 11.5 8.5",class:"svg-out"}),t("path",{d:"M8,1 L8,11",class:"svg-out"})],-1)),en=[Zt],tn={key:0,class:""},nn={key:1,class:"flex justify-center"},on=I(()=>t("img",{class:"h-[450px]",src:K,alt:"",srcset:""},null,-1)),an=[on],sn={class:"bg-[#000] text-[#fff] w-[100%] h-[60px] absolute top-0 left-0"},ln={class:"m-4 text-[#ffff] font-['poppins] font-semibold relative"},rn={key:0,class:""},cn={class:"flex justify-start items-center gap-2"},dn=["src"],un={class:"font-semibold text-[#0873CD] font-['poppins'] text-[14px]"},pn={class:"font-['poppins'] text-[#535353] text-[12px]"},vn={key:1,class:"flex justify-center"},_n=I(()=>t("img",{class:"h-[450px]",src:K,alt:"",srcset:""},null,-1)),mn=[_n],hn={__name:"attendanceDashboard",setup(x){const e=F(),b=se(),i=d(!1);G(async()=>{await e.getAttendanceDashboardMainSource(),e.GetDepartment()});const v=d();G(async()=>{await e.getAttendanceDashboardMainSource(),e.GetDepartment()});const S=async()=>{const _=new Z.Workbook,o=_.addWorksheet("Sheet1"),a=["user_code","user_code","shift_start_time","shift_end_time","shift_end_time"],r="this report generated by ABShrms payroll software ",s=a;o.addRow(s).eachCell(($,O)=>{$.fill={type:"pattern",pattern:"solid",fgColor:{argb:"252f70"}},$.font={bold:!0,color:{argb:"ffffff"}},o.getColumn(O).width=20}),Object.values(e.currentlySelectedShiftDetails).forEach(($,O)=>{console.log($);const H=[];s.forEach(M=>{H.push($[M])}),o.addRow(H)}),o.addRow([""]);const y=o.addRow([""]);y.getCell(1).value=r,o.mergeCells(y.number,1,y.number,3),y.getCell(1).alignment={wrapText:!0},y.getCell(1).font={italic:!0};const D=await _.xlsx.writeBuffer(),u=window.URL.createObjectURL(new Blob([D])),f=document.createElement("a");f.href=u,f.download="shift.xlsx",f.click(),window.URL.revokeObjectURL(u)},c=d(!1),w=d("downloaded");return(_,o)=>{const a=P("Dropdown"),r=P("Calendar"),s=P("Dialog"),l=P("Column"),y=P("DataTable"),D=P("Sidebar");return p(),g(V,null,[n(e).canShowLoading?(p(),L(ae,{key:0,class:"absolute z-50 bg-white"})):A("",!0),t("div",Bt,[Ft,t("div",It,[t("div",Ut,[t("p",Tt,[T(" Daily Analytics - "),t("span",Vt,m(_.date?n(J)(_.date).format("MMMM DD,YYYY"):n(J)(new Date).format("MMMM DD,YYYY")),1)])]),t("div",Gt,[t("div",null,[h(a,{onChange:o[0]||(o[0]=u=>n(e).send_selectedDepartment(v.value,"")),optionValue:"id",modelValue:v.value,"onUpdate:modelValue":o[1]||(o[1]=u=>v.value=u),optionLabel:"name",options:n(e).departments,placeholder:"Select a Department",class:"w-full md:w-18rem h-[36px]"},null,8,["modelValue","options"])]),t("div",null,[h(a,{optionLabel:"name",placeholder:"Select a Location",class:"w-full md:w-14rem h-[36px]"})]),t("div",null,[t("i",{class:"pi pi-calendar text-blue-500 text-[16px]",onClick:o[2]||(o[2]=u=>i.value=!0)})]),h(s,{visible:i.value,"onUpdate:visible":o[6]||(o[6]=u=>i.value=u),modal:"",header:"Calendar",style:{width:"30vw"}},{default:j(()=>[t("div",Nt,[h(r,{modelValue:_.date,"onUpdate:modelValue":o[3]||(o[3]=u=>_.date=u),inline:"",maxDate:new Date,onDateSelect:o[4]||(o[4]=u=>n(e).send_selectedDepartment(v.value,_.date?i.value=!1:i.value=!0))},null,8,["modelValue","maxDate"])]),t("button",{onClick:o[5]||(o[5]=u=>i.value=!1),class:"absolute top-4 right-4"},Yt)]),_:1},8,["visible"])])]),t("div",zt,[h(Te)]),t("div",Wt,[t("div",null,[h(qe)]),t("div",null,[h(st)]),t("div",null,[h(ft)])]),t("div",Jt,[h(jt)])]),h(D,{visible:n(e).canShowShiftDetails,"onUpdate:visible":o[8]||(o[8]=u=>n(e).canShowShiftDetails=u),position:"right",style:{width:"60vw !important"}},{header:j(()=>[t("div",qt,[t("h1",Xt,m(n(e).currentlySelectedShiftDetails?n(e).currentlySelectedShiftDetails[0].shift_name:null),1)]),t("div",Kt,[t("button",{class:"bg-[#E6E6E6] p-2 mx-2 rounded-md w-[120px]",onClick:o[7]||(o[7]=u=>(c.value=!c.value,S()))},[Qt,t("div",{id:"btn-download",style:{position:"absolute",right:"0"},class:B([c.value==!0?w.value:" "])},en,2)])])]),default:j(()=>[Object.values(n(e).currentlySelectedShiftDetails).length>=1?(p(),g("div",tn,[h(y,{scrollable:"",scrollHeight:"450px",value:n(e).currentlySelectedShiftDetails?n(e).currentlySelectedShiftDetails:[]},{default:j(()=>[h(l,{field:"Employee_Code",header:"User code"}),h(l,{field:"Employee_Name",header:"Name"}),h(l,{field:"shift_start_time",header:"Shift start time"}),h(l,{field:"shift_end_time",header:"Shift end time"}),h(l,{field:"grace_time",header:"Grace time"})]),_:1},8,["value"])])):(p(),g("div",nn,an))]),_:1},8,["visible"]),h(D,{visible:n(e).canShowAttendanceOverview,"onUpdate:visible":o[9]||(o[9]=u=>n(e).canShowAttendanceOverview=u),position:"right",style:{width:"60vw !important"}},{header:j(()=>[t("div",sn,[t("h1",ln,m(n(e).selectedAttendanceOverviewReport)+" Reports",1)])]),default:j(()=>[Object.values(n(e).currentlySelectedShiftDetails).length>=1?(p(),g("div",rn,[h(y,{scrollable:"",scrollHeight:"450px",value:n(e).currentlySelectedShiftDetails?n(e).currentlySelectedShiftDetails:[]},{default:j(()=>[h(l,{field:"Employee_Name",header:"Employee Name",style:q([{width:"300px !important"},{width:"200px !important"}])},{body:j(u=>[t("div",cn,[JSON.parse(u.data.shortname_avatar).type=="shortname"?(p(),g("span",{key:0,class:B(["font-semibold text-white rounded-full w-[34px] h-[34px] font-['poppins'] text-[12px] flex justify-center items-center",n(b).getBackgroundColor(u.index)]),style:{"vertical-align":"middle"}},m(JSON.parse(u.data.shortname_avatar).data),3)):(p(),g("img",{key:1,class:"rounded-circle userActive-status profile-img",style:{height:"30px !important",width:"30px !important"},src:`data:image/png;base64,${u.data.shortname_avatar.data}`,srcset:"",alt:""},null,8,dn)),t("span",{class:B(["flex flex-col justify-start items-start","w-[200px]"])},[t("span",un,m(u.data.Employee_Name),1),t("span",pn,m(u.data.Employee_Code)+" ",1)])])]),_:1}),h(l,{field:"Department",header:"Department",style:{}}),h(l,{field:"Process",header:"Process",style:{}}),h(l,{field:"Location",header:"Location",style:{}}),n(e).selectedAttendanceOverviewReport!="Absent"&&n(e).selectedAttendanceOverviewReport!="Leave"?(p(),L(l,{key:0,field:"checkin_time",header:"Check In Time"})):A("",!0),n(e).selectedAttendanceOverviewReport!="Absent"&&n(e).selectedAttendanceOverviewReport!="Late Coming"&&n(e).selectedAttendanceOverviewReport!="leave"?(p(),L(l,{key:1,field:"checkout_time",header:"Check Out Time"})):A("",!0),n(e).selectedAttendanceOverviewReport!="Leave"&&n(e).selectedAttendanceOverviewReport!="Absent"&&n(e).selectedAttendanceOverviewReport!="Early going"?(p(),L(l,{key:2,field:"late_min",header:"Late coming"})):A("",!0),n(e).selectedAttendanceOverviewReport=="Early Going"&&n(e).selectedAttendanceOverviewReport!="Leave"?(p(),L(l,{key:3,field:"eg_min",header:"Early Going"})):A("",!0),n(e).selectedAttendanceOverviewReport=="Leave"?(p(),L(l,{key:4,field:"leave_status",header:"leave Status"})):A("",!0),n(e).selectedAttendanceOverviewReport=="Leave"?(p(),L(l,{key:5,field:"leave_type",header:"Leave Type"})):A("",!0),n(e).selectedAttendanceOverviewReport=="Absent"?(p(),L(l,{key:6,field:"status",header:"Status"})):A("",!0)]),_:1},8,["value"])])):(p(),g("div",vn,mn))]),_:1},8,["visible"])],64)}}},Dn=te(hn,[["__scopeId","data-v-eb7d401e"]]);export{Dn as default};
