import{r as x,K as me,y as ve,v as fe,z as _e,o as pe,p as ee,b as H,d as m,e as _,g,j as ye,i as w,f as e,m as v,k as c,P as V,F as he,t as i,h as W,n as te,w as ge,L as xe,D as ae}from"./app-e1ab7da0.js";import{d as P}from"./dayjs.min-ac6c82aa.js";import{S as be}from"./Service-a2d19084.js";import{L as we}from"./LoadingSpinner-1df67a25.js";import{u as De}from"./LeaveModuleService-22be0d8f.js";import{u as Me,c as Te,r as ke}from"./index.esm-8509f6bf.js";/* empty css                                                                       */var Ne=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,Se=/\b(?:[A-Z]{1,3}[A-Z][TC])(?:[-+]\d{4})?|((?:Australian )?(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time)\b/g,Ce=/[^-+\dA-Z]/g;function Le(r,l,d,y){if(arguments.length===1&&typeof r=="string"&&!/\d/.test(r)&&(l=r,r=void 0),r=r||r===0?r:new Date,r instanceof Date||(r=new Date(r)),isNaN(r))throw TypeError("Invalid date");l=String(ne[l]||l||ne.default);var M=l.slice(0,4);(M==="UTC:"||M==="GMT:")&&(l=l.slice(4),d=!0,M==="GMT:"&&(y=!0));var n=function(){return d?"getUTC":"get"},f=function(){return r[n()+"Date"]()},C=function(){return r[n()+"Day"]()},h=function(){return r[n()+"Month"]()},T=function(){return r[n()+"FullYear"]()},p=function(){return r[n()+"Hours"]()},u=function(){return r[n()+"Minutes"]()},L=function(){return r[n()+"Seconds"]()},A=function(){return r[n()+"Milliseconds"]()},k=function(){return d?0:r.getTimezoneOffset()},$=function(){return Ae(r)},j=function(){return je(r)},R={d:function(){return f()},dd:function(){return D(f())},ddd:function(){return b.dayNames[C()]},DDD:function(){return oe({y:T(),m:h(),d:f(),_:n(),dayName:b.dayNames[C()],short:!0})},dddd:function(){return b.dayNames[C()+7]},DDDD:function(){return oe({y:T(),m:h(),d:f(),_:n(),dayName:b.dayNames[C()+7]})},m:function(){return h()+1},mm:function(){return D(h()+1)},mmm:function(){return b.monthNames[h()]},mmmm:function(){return b.monthNames[h()+12]},yy:function(){return String(T()).slice(2)},yyyy:function(){return D(T(),4)},h:function(){return p()%12||12},hh:function(){return D(p()%12||12)},H:function(){return p()},HH:function(){return D(p())},M:function(){return u()},MM:function(){return D(u())},s:function(){return L()},ss:function(){return D(L())},l:function(){return D(A(),3)},L:function(){return D(Math.floor(A()/10))},t:function(){return p()<12?b.timeNames[0]:b.timeNames[1]},tt:function(){return p()<12?b.timeNames[2]:b.timeNames[3]},T:function(){return p()<12?b.timeNames[4]:b.timeNames[5]},TT:function(){return p()<12?b.timeNames[6]:b.timeNames[7]},Z:function(){return y?"GMT":d?"UTC":Re(r)},o:function(){return(k()>0?"-":"+")+D(Math.floor(Math.abs(k())/60)*100+Math.abs(k())%60,4)},p:function(){return(k()>0?"-":"+")+D(Math.floor(Math.abs(k())/60),2)+":"+D(Math.floor(Math.abs(k())%60),2)},S:function(){return["th","st","nd","rd"][f()%10>3?0:(f()%100-f()%10!=10)*f()%10]},W:function(){return $()},WW:function(){return D($())},N:function(){return j()}};return l.replace(Ne,function(a){return a in R?R[a]():a.slice(1,a.length-1)})}var ne={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},b={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},D=function(l){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(l).padStart(d,"0")},oe=function(l){var d=l.y,y=l.m,M=l.d,n=l._,f=l.dayName,C=l.short,h=C===void 0?!1:C,T=new Date,p=new Date;p.setDate(p[n+"Date"]()-1);var u=new Date;u.setDate(u[n+"Date"]()+1);var L=function(){return T[n+"Date"]()},A=function(){return T[n+"Month"]()},k=function(){return T[n+"FullYear"]()},$=function(){return p[n+"Date"]()},j=function(){return p[n+"Month"]()},R=function(){return p[n+"FullYear"]()},a=function(){return u[n+"Date"]()},F=function(){return u[n+"Month"]()},E=function(){return u[n+"FullYear"]()};return k()===d&&A()===y&&L()===M?h?"Tdy":"Today":R()===d&&j()===y&&$()===M?h?"Ysd":"Yesterday":E()===d&&F()===y&&a()===M?h?"Tmw":"Tomorrow":f},Ae=function(l){var d=new Date(l.getFullYear(),l.getMonth(),l.getDate());d.setDate(d.getDate()-(d.getDay()+6)%7+3);var y=new Date(d.getFullYear(),0,4);y.setDate(y.getDate()-(y.getDay()+6)%7+3);var M=d.getTimezoneOffset()-y.getTimezoneOffset();d.setHours(d.getHours()-M);var n=(d-y)/(864e5*7);return 1+Math.floor(n)},je=function(l){var d=l.getDay();return d===0&&(d=7),d},Re=function(l){return(String(l).match(Se)||[""]).pop().replace(Ce,"").replace(/GMT\+0000/g,"UTC")};const Fe={class:"w-full p-2 bg-white rounded-lg"},He=e("div",{class:"col-sm-12 col-xxl-6 col-md-6 col-xl-6 col-lg-6"},[e("h6",{class:"my-2 text-lg font-semibold"},"Leave Approvals")],-1),Ye={class:"mt-3 ml-3 confirmation-content d-flex justify-content-start align-items-center"},$e=e("i",{class:"mr-3 text-red-600 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),Oe={class:"w-full pl-3 mt-4 d-flex justify-content-start align-items-center",style:{"margin-bottom":"-12px"}},Ve={class:"flex justify-center items-center gap-3"},We={class:"confirmation-content"},Ue=e("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),Ee={class:"mt-3"},ze={class:"text-left"},Je={class:"p-input-icon-left"},Pe=e("i",{class:"pi pi-search"},null,-1),qe={class:"flex items-center justify-center"},Ze=["src"],Be={class:"pl-2 text-[#000] text-[14px] flex flex-col font-semibold text-left fs-6"},Ge={class:"text-[#535353] font-['poppins'] text-[12px] font-normal"},Ie={class:"text-start text-[#000]"},Ke={class:"text-start text-[#000]"},Qe=e("div",null,null,-1),Xe={class:"text-start text-[#000]"},et={class:"text-start text-[#000]"},tt={key:0},at={key:0,class:"!line-clamp-4"},nt={key:0},ot=["onClick"],st={key:1,class:"text-start text-[#000] !line-clamp-4"},rt=["onClick"],lt={key:1},it={class:"text-start text-[#000]"},dt={key:0},ut={key:0,class:"!line-clamp-4"},ct={key:0},mt={key:1,class:"text-start text-[#000] !line-clamp-4"},vt={key:1},ft={key:0,class:"gap-2 justify-center items-center flex"},_t=["onClick"],pt=e("i",{class:"pi pi-check"},null,-1),yt=[pt],ht=["onClick"],gt=e("i",{class:"pi pi-times"},null,-1),xt=[gt],bt={key:1},wt=["onClick"],Dt=e("i",{class:"pi pi-eye"},null,-1),Mt=[Dt],Tt=e("div",{class:"bg-[#000] w-[100%] h-[60px] absolute top-0 left-0"},[e("h1",{class:"m-4 text-[#ffff] font-['poppins] font-semibold"},"Leave Details")],-1),kt={class:"flex items-center mt-6"},Nt=e("img",{src:"",alt:"",class:"rounded-full"},null,-1),St={class:"bg-blue-200 w-[40px] h-[40px] rounded-full mr-4 ml-2 flex items-center justify-center"},Ct={class:"flex flex-col items-center justify-center"},Lt={class:"font-semibold"},At={class:"grid grid-cols-3 gap-2 p-2 my-2 mx-2 bg-gray-200 rounded-md"},jt={class:"flex flex-col"},Rt=e("b",null,"Leave Type",-1),Ft={class:"flex flex-col"},Ht=e("b",null,"Start Date",-1),Yt={class:"flex flex-col"},$t=e("b",null,"End Date",-1),Ot={class:"flex flex-col"},Vt=e("b",null,"Total Leave Days",-1),Wt={class:"flex flex-col"},Ut=e("b",null,"Status",-1),Et={class:"my-2 p-2 h-[60px]"},zt=e("b",null,"Leave Reason",-1),Jt={class:"p-2 my-2"},Pt=e("b",null,"Notified to",-1),qt={class:"flex items-center mt-2"},Zt=e("img",{src:"",alt:"",class:"rounded-full"},null,-1),Bt=e("div",{class:"bg-orange-200 w-[40px] h-[40px] rounded-full mr-4 flex items-center justify-center"},null,-1),Gt={class:"flex flex-col items-center justify-center"},It={class:"font-semibold"},Kt={key:0,class:"flex flex-col p-2"},Qt=e("b",null,[W("Comments"),e("span",{class:"text-danger"},"*")],-1),Xt={key:0,class:"font-semibold text-red-400 fs-6"},ea={class:"flex justify-center items-center mt-[50px]"},ia={__name:"LeaveApproval",setup(r){const l=x(!1),d=be(),y=De();let M=x(),n=x(!1),f=x(!1),C=x(),h=x(!1);me();const T=ve(),p=x(),u=x(),L=x(),A=x({global:{value:null,matchMode:ae.CONTAINS},status:{value:null,matchMode:ae.EQUALS}});x(!1);const k=x(["Pending","Approved","Rejected","Withdrawn"]),$=x(),j=x(),R=o=>{j.value=o,$.value=o},a=fe(()=>({revoking_comment:{required:Te.withMessage("Comments is Required",ke)}})),F=Me(a,y);function E(o){F.value.$validate(),F.value.$error?(F.value="",console.log("Form failed validation")):(console.log("Form successfully submitted."),y.revokeLeaveRequest(o),l.value=!1,F.value="")}function N(o,s){T.add({severity:o,summary:s,life:3e3})}let Y=null,z=null;const q=_e({review_comment:""});pe(()=>{se()});function se(){h.value=!0;let o=window.location.origin+"/fetch-leaverequests-based-on-currentrole";ee.get(o).then(s=>{M.value=s.data.data}).finally(()=>{h.value=!1})}function Z(o){return isNaN(Date.parse(o))?"Invalid date":Le(o,"dd-mm-yyyy, h:MM TT")}function B(o,s){f.value=!1,n.value=!0,Y=s,z=o,console.log("Selected Row Data : "+JSON.stringify(o))}function G(o){n.value=!1,o&&J()}function J(){Y="",z=null}function I(){console.log(q.review_comment),G(!1),h.value=!0,ee.post(window.location.origin+"/attendance-approve-rejectleave",{record_id:z.id,status:Y=="Approve"?"Approved":Y=="Reject"?"Rejected":Y,review_comment:q.review_comment}).then(o=>{console.log(o),J(),Swal.fire({title:o.data.status=="success"?"Success":"Oops!",text:o.data.message,icon:o.data.status=="success"?"success":"error"})}).catch(o=>{h.value=!1,J(),console.log(o.toJSON())}).finally(()=>{h.value=!1})}const K=o=>{switch(o){case"Rejected":return"danger";case"Approved":return"success";case"Pending":return"warning"}};return(o,s)=>{const re=H("Toast"),le=H("Textarea"),Q=H("Dialog"),ie=H("InputText"),S=H("Column"),X=H("Tag"),de=H("Dropdown"),ue=H("DataTable"),ce=H("Sidebar");return m(),_(he,null,[g(h)?(m(),ye(we,{key:0,class:"absolute z-50 bg-white"})):w("",!0),e("div",Fe,[He,v(re),v(Q,{header:"Confirmation",visible:g(n),"onUpdate:visible":s[3]||(s[3]=t=>V(n)?n.value=t:n=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"450px"},modal:!0},{footer:c(()=>[e("div",Ve,[e("button",{class:"bg-[#F9BE00] px-4 rounded-md text-[#000] h-[25px]",onClick:s[1]||(s[1]=t=>(g(Y)=="Reject"?p.value?(I(),V(n)?n.value=!0:n=!0):(V(n)?n.value=!0:n=!0,N("warn"," Reviewer Comment required")):I(),V(n)?n.value=!1:n=!1))},"Yes"),e("button",{class:"bg-[#000] px-4 rounded-md text-[#fff] h-[25px]",onClick:s[2]||(s[2]=t=>G(!0))},"No")])]),default:c(()=>[e("div",Ye,[$e,e("span",null,"Are you sure you want to "+i(g(Y))+"?",1)]),e("div",Oe,[v(le,{name:"",id:"",modelValue:p.value,"onUpdate:modelValue":s[0]||(s[0]=t=>p.value=t),class:"p-2 border rounded",cols:"45",rows:"4",autoResize:"",placeholder:"Add Comment"},null,8,["modelValue"])])]),_:1},8,["visible"]),v(Q,{header:"Error",visible:g(f),"onUpdate:visible":s[5]||(s[5]=t=>V(f)?f.value=t:f=t),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{footer:c(()=>[e("button",{class:"bg-[#000] px-4 rounded-md text-[#fff] h-[25px]",onClick:s[4]||(s[4]=t=>V(f)?f.value=!1:f=!1)},"No")]),default:c(()=>[e("div",We,[Ue,e("span",null,"Error while processing the request : "+i(g(C)),1)])]),_:1},8,["visible"]),e("div",Ee,[v(ue,{value:g(M),paginator:!0,rows:10,dataKey:"emp_user_code",rowsPerPageOptions:[5,10,25],paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",responsiveLayout:"scroll",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}",sortField:"leaverequest_date",sortOrder:-1,filters:A.value,"onUpdate:filters":s[9]||(s[9]=t=>A.value=t),filterDisplay:"menu",globalFilterFields:["employee_name","emp_user_code","leave_type","status"],style:{"white-space":"nowrap"}},{header:c(()=>[e("div",ze,[e("div",Je,[Pe,v(ie,{class:"border p-1.5 bg-gray-100 border-gray-300",modelValue:A.value.global.value,"onUpdate:modelValue":s[6]||(s[6]=t=>A.value.global.value=t),placeholder:"Global Search"},null,8,["modelValue"])])])]),empty:c(()=>[W(" No Employee found ")]),loading:c(()=>[W(" Loading customers data. Please wait. ")]),default:c(()=>[v(S,{class:"font-bold",field:"employee_name",header:"Employee Name",style:{"min-width":"18em"}},{body:c(t=>[e("div",qe,[JSON.parse(t.data.employee_avatar).type=="shortname"?(m(),_("p",{key:0,class:te(["p-2 font-semibold text-white rounded-full w-11 fs-6",g(d).getBackgroundColor(t.index)])},i(JSON.parse(t.data.employee_avatar).data),3)):(m(),_("img",{key:1,class:"w-10 rounded-circle img-md userActive-status profile-img",style:{height:"30px !important"},src:`data:image/png;base64,${JSON.parse(t.data.employee_avatar).data}`,srcset:"",alt:""},null,8,Ze)),e("p",Be,[W(i(t.data.employee_name)+" ",1),e("span",Ge,i(t.data.emp_user_code),1)])])]),_:1}),v(S,{field:"leaverequest_date",header:"Date",sortable:!0},{body:c(t=>[e("p",Ie,i(g(P)(t.data.leaverequest_date).format("DD-MMM-YYYY , h:MM A")),1)]),_:1}),v(S,{field:"leave_type",header:"Leave Type",style:{"min-width":"10em","white-space":"pre-wrap"}},{body:c(t=>[e("p",Ke,i(t.data.leave_type),1),Qe]),_:1}),v(S,{field:"start_date",header:"Start Time"},{body:c(t=>[e("p",Xe,i(Z(t.data.start_date)),1)]),_:1}),v(S,{field:"end_date",header:"End Time"},{body:c(t=>[e("p",et,i(Z(t.data.end_date)),1)]),_:1}),v(S,{field:"leave_reason",header:"Leave Reason",style:{"min-width":"10em","white-space":"pre-wrap"}},{body:c(t=>[t.data.leave_reason.length>30?(m(),_("div",tt,[L.value!=t.data.id?(m(),_("div",at,[t.data.leave_reason.length>30?(m(),_("p",nt,i(t.data.leave_reason.substring(0,30)+"..."),1)):w("",!0),t.data.leave_reason.length>30?(m(),_("button",{key:1,onClick:O=>(L.value=t.data.id,R(t.data.id)),class:"font-medium text-blue-400 underline cursor-pointer"}," more... ",8,ot)):w("",!0)])):w("",!0),L.value==t.data.id?(m(),_("div",st,[W(i(t.data.leave_reason)+" ",1),e("button",{onClick:O=>(L.value="",R(t.data.id)),class:"font-medium text-blue-400 underline cursor-pointer"}," Less... ",8,rt)])):w("",!0)])):(m(),_("div",lt,i(t.data.leave_reason),1))]),_:1}),v(S,{field:"reviewer_name",header:"Approver Name"},{body:c(t=>[e("p",it,i(t.data.reviewer_name),1)]),_:1}),v(S,{field:"reviewer_comments",header:"Comments"},{default:c(()=>[e("template",null,[o.slotProps.data.reviewer_comments.length>70?(m(),_("div",dt,[j.value!=o.slotProps.data.id?(m(),_("div",ut,[o.slotProps.data.reviewer_comments.length>70?(m(),_("p",ct,i(o.slotProps.data.reviewer_comments.substring(0,70)+"..."),1)):w("",!0),o.slotProps.data.reviewer_comments.length>70?(m(),_("button",{key:1,onClick:s[7]||(s[7]=t=>(j.value=o.slotProps.data.id,R(o.slotProps.data.id))),class:"font-medium text-blue-400 underline cursor-pointer"}," more... ")):w("",!0)])):w("",!0),j.value==o.slotProps.data.id?(m(),_("div",mt,[W(i(o.slotProps.data.reviewer_comments)+" ",1),e("button",{onClick:s[8]||(s[8]=t=>(j.value="",R(o.slotProps.data.id))),class:"font-medium text-blue-400 underline cursor-pointer"}," Less... ")])):w("",!0)])):(m(),_("div",vt,i(o.slotProps.data.reviewer_comments?o.slotProps.data.reviewer_comments:"-"),1))])]),_:1}),v(S,{field:"status",header:"Status",icon:"pi pi-check"},{body:c(({data:t})=>[v(X,{value:t.status,severity:K(t.status)},null,8,["value","severity"])]),filter:c(({filterModel:t,filterCallback:O})=>[v(de,{modelValue:t.value,"onUpdate:modelValue":U=>t.value=U,onChange:U=>O(),options:k.value,placeholder:"Select One",class:"p-column-filter",style:{"min-width":"12rem"},showClear:!0},{option:c(U=>[v(X,{value:U.option,severity:K(U.option)},null,8,["value","severity"])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","options"])]),_:1}),v(S,{style:{width:"300px"},field:"",header:"Actions"},{body:c(t=>[t.data.status=="Pending"?(m(),_("span",ft,[e("button",{class:"bg-[#F9BE00] px-4 rounded-md text-[#000] h-[25px] flex justify-center items-center",onClick:O=>B(t.data,"Approve")},yt,8,_t),e("button",{class:"bg-black px-4 rounded-md text-[#ffff] h-[25px] flex justify-center items-center",onClick:O=>B(t.data,"Reject")},xt,8,ht)])):w("",!0),t.data.status=="Approved"||t.data.status=="Rejected"||t.data.status=="Withdrawn"?(m(),_("span",bt,[e("button",{onClick:O=>(l.value=!0,u.value=t.data)},Mt,8,wt)])):w("",!0)]),_:1})]),_:1},8,["value","filters"])]),v(ce,{visible:l.value,"onUpdate:visible":s[12]||(s[12]=t=>l.value=t),position:"right",style:{width:"40vw !important"}},{header:c(()=>[Tt]),default:c(()=>[e("div",kt,[Nt,e("div",St,i(JSON.parse(u.value.employee_avatar).data),1),e("div",Ct,[e("h1",Lt,i(u.value.employee_name),1),e("p",null,i(u.value.emp_user_code),1)])]),e("div",At,[e("div",jt,[Rt,e("span",null,i(u.value.leave_type),1)]),e("div",Ft,[Ht,e("span",null,i(g(P)(u.value.start_date).format("DD-MMM-YYYY")),1)]),e("div",Yt,[$t,e("span",null,i(g(P)(u.value.end_date).format("DD-MMM-YYYY")),1)]),e("div",Ot,[Vt,e("span",null,i(u.value.total_leave_datetime),1)]),e("div",Wt,[Ut,e("span",null,i(u.value.status),1)])]),e("div",Et,[zt,e("p",null,i(u.value.leave_reason),1)]),e("div",Jt,[Pt,e("div",qt,[Zt,Bt,e("div",Gt,[e("h1",It,i(u.value.reviewer_name),1),e("p",null,i(u.value.reviewer_user_code),1)])])]),u.value.status.includes("Approved")||u.value.status.includes("Rejected")?(m(),_("div",Kt,[Qt,ge(e("textarea",{"onUpdate:modelValue":s[10]||(s[10]=t=>g(y).revoking_comment=t),name:"",id:"",cols:"10",rows:"5",class:te(["mx-2 border-[1px] border-[#000] rounded-lg mt-2 p-2",[g(F).revoking_comment.$error?"p-invalid":""]])},null,2),[[xe,g(y).revoking_comment]]),g(F).revoking_comment.$error?(m(),_("span",Xt,i(g(F).revoking_comment.$errors[0].$message),1)):w("",!0)])):w("",!0),e("div",ea,[e("button",{onClick:s[11]||(s[11]=t=>E(u.value.id)),class:"bg-[#000] text-[#fff] rounded-md font-semibold p-2 mx-2 text-[12px]"},"Revoke")])]),_:1},8,["visible"])])],64)}}};export{ia as default};
