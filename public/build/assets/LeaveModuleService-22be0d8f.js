import{x as ie,q as ce,y as ve,r as t,p as s}from"./app-e1ab7da0.js";import{d as T}from"./dayjs.min-ac6c82aa.js";import{S as re}from"./Service-a2d19084.js";ie("$swal");const _e=ce("useLeaveModuleStore",()=>{const v=ve(),H=re(),n=t(!0),d=t(),f=t(),k=t(),x=t(),A=t(),y=t(),_=t(),g=t(),j=t(),m=t(),N=t(),p=t(!1),c=t(""),r=t(),h=t({}),q=e=>{p.value=!0,console.log(e),h.value={...e},h.emp_name=e.name};async function U(e){n.value=!0;let a="/get-employee-leave-balance";await s.post(a,{id:e}).then(l=>{console.log(l.data),d.value=l.data,f.value=l.data["Avalied Leaves"]}).finally(()=>{n.value=!1})}const R=t("");async function J(e){await s.post("/leave/withdrawLeave",{leave_id:e,withdraw_comment:R.value}).then(a=>{Swal.fire({title:a.data.status,text:a.data.message,icon:a.data.status=="failure"?"warning":"success"}),p.value=!1,console.log("performLeaveWithdraw() : "+a.data)}).finally(()=>{n.value=!1})}async function $(e,a,l){let i=0;n.value=!0,await s.get(window.location.origin+"/currentUserCode ").then(o=>{i=o.data}),await s.post("/attendance/getEmployeeLeaveDetails",{user_code:i,filter_month:e,filter_year:a,filter_leave_status:l}).then(o=>{k.value=o.data.data,console.log("getEmployeeLeaveHistory() : "+o.data)}).finally(()=>{n.value=!1})}async function z(e,a,l){let i=0;await s.get(window.location.origin+"/currentUserCode ").then(o=>{i=o.data}),s.post("/attendance/getTeamEmployeesLeaveDetails",{manager_code:i,filter_month:e,filter_year:a,filter_leave_status:l}).then(o=>{x.value=o.data.data,console.log("getTeamLeaveHistory() : "+o.data)}).finally(()=>{n.value=!1})}async function G(e,a,l){s.post("/attendance/getAllEmployeesLeaveDetails",{filter_month:e,filter_year:a,filter_leave_status:l}).then(i=>{A.value=i.data.data,console.log("getOrgLeaveHistory() : "+i.data.data)}).finally(()=>{n.value=!1})}const W=t("");async function K(e){n.value=!1,s.post(window.location.origin+"/attendance-approve-rejectleave",{record_id:e,approver_user_code:H.current_user_code,status:"Revoked",review_comment:W.value}).then(a=>{Swal.fire({title:a.data.status=="success"?"Success":"Oops!",text:a.data.message,icon:a.data.status=="success"?"success":"error"})}).catch(a=>{n.value=!1,console.log(a.toJSON())}).finally(()=>{n.value=!1})}async function P(e){s.post("/attendance/getLeaveInformation",{record_id:e}).then(a=>{N.value=a.data.data,console.log("getLeaveInformation() : "+a.data)}).finally(()=>{n.value=!1})}const w=t(new Date);async function Q(e){await s.post("/fetch-org-leaves-balance",{id:e}).then(a=>{y.value=a.data}).finally(()=>{n.value=!1})}const L=t(),b=t(),D=t();function V(){r.value.map(e=>{e.id==c.value&&(L.value=e.start_date,b.value=e.end_date)}),D.value=T(w.value).format("YYYY-MM-DD"),C(L.value,b.value,D.value)}async function C(e,a,l){if(console.log(e,a,l),l>=e&&l<=a){let i="/fetch-org-leaves-balance";await s.post(i,{id:c.value,month:l}).then(o=>{console.log(o.data),y.value=o.data}).finally(()=>{n.value=!1})}else console.log("false"),v.add({severity:"warn",summary:"Oops",detail:"choose month between financial year",life:3e3}),w.value=new Date}const F=t("");async function X(e){await s.post("/fetch-team-leave-balance",{id:e}).then(a=>{m.value=a.data}).finally(()=>{n.value=!1})}const Y=t(""),O=t(""),S=t("");function Z(){r.value.map(e=>{e.id==c.value&&(Y.value=e.start_date,O.value=e.end_date)}),S.value=T(F.value).format("YYYY-MM-DD"),ee(Y.value,O.value,S.value)}async function ee(e,a,l){if(console.log(e,a,l),l>=e&&l<=a){let i="/fetch-team-leave-balance";await s.post(i,{id:c.value,month:l}).then(o=>{console.log(o.data),m.value=o.data}).finally(()=>{n.value=!1})}else console.log("false"),v.add({severity:"warn",summary:"Oops",detail:"choose month between financial year",life:3e3}),u.value=new Date}function ae(){_.value="",g.value="",console.log(" this variable is cleared ::",g.value,_.value)}const te=async()=>{await s.get("/get-financial-years").then(e=>{console.log(e.data.data,"get-financial-years"),r.value=e.data.data,e.data.data.map(({status:a,id:l})=>{a==1&&(c.value=l)})}).catch(e=>{console.log(e)})},I=t([]),le=async()=>{let e=window.location.origin+"/api/leave/getLeaveNotifyToList";await s.post(e,{user_code:H.current_user_code}).then(a=>{console.log(a.data.data),I.value=a.data.data}).catch(a=>{console.log(a)})},u=t(),B=t(""),E=t(""),M=t("");function oe(){r.value.map(e=>{e.id==c.value&&(B.value=e.start_date,E.value=e.end_date)}),M.value=T(u.value).format("YYYY-MM-DD"),ne(B.value,E.value,M.value)}async function ne(e,a,l){if(l>=e&&l<=a){let i="/get-employee-leave-balance";await s.post(i,{id:c.value,month:l}).then(o=>{console.log(o.data),d.value=o.data,f.value=o.data["Avalied Leaves"]}).finally(()=>{n.value=!1})}else console.log("false"),v.add({severity:"warn",summary:"Oops",detail:"choose month between financial year",life:3e3}),u.value=new Date}const se=t([]);return{canShowLoading:n,canShowLeaveDetails:p,setLeaveDetails:h,getLeaveDetails:q,array_employeeLeaveHistory:k,array_teamLeaveHistory:x,array_orgLeaveHistory:A,array_employeeLeaveBalance:d,array_employeeAvailedLeaveBalance:f,array_orgLeaveBalance:y,selectedStartDate:_,selectedEndDate:g,canshowloadingsrceen:j,arrayTermLeaveBalance:m,leave_notify_to_dropdown:I,performLeaveWithdraw:J,getEmployeeLeaveHistory:$,getTeamLeaveHistory:z,getAllEmployeesLeaveHistory:G,revokeLeaveRequest:K,getLeaveInformation:P,getEmployeeLeaveBalance:U,getOrgLeaveBalance:Q,getLeaveNotifyDropdown:le,selectedOrgDate:w,getOrgLeaveBalFilter:V,isOrgWithinRange:C,org_start_date:L,org_end_date:b,selected_org_date:D,getTermLeaveBalance:X,selectedTeamDate:F,team_fy_end:O,team_fy_start:Y,selected_team_date:S,getTeamLeaveBalFilter:Z,clearfunction:ae,getFinancialYearDropdown:te,financial_year_leave_dropdown:r,financial_year:c,checkLeaveEligibility:async e=>{await s.get("/fetch-leave-policy-details").then(a=>{a.data.map(l=>{e===l.leave_type&&(l.is_finite===1?l.leave_balance>=1?console.log("finite 1 true"):v.add({severity:"warn",summary:"Oops",detail:"Cannot able to apply Leave",life:3e3}):(leave,v.add({severity:"warn",summary:"Oops",detail:"Cannot able to apply Leave",life:4e3})))})}).catch(a=>{console.log(a)})},check_leave_types:se,revoking_comment:W,withdraw_comment:R,selectedLeaveMonth:u,leaveBalMonthFilter:oe,selected_leave_bal_date:M,fy_end_date:E,fy_start_date:B}});export{_e as u};
