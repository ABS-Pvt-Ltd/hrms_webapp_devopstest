import{r as i,y as I,o as Q,p as A,b,d as O,e as G,m as l,g as d,j as H,i as K,f as s,k as n,P as j,F as W,t as h,h as _,D as S}from"./app-e1ab7da0.js";import{d as q}from"./dayjs.min-ac6c82aa.js";import{m as X}from"./map-e2bf2fda.js";import{L as Z}from"./LoadingSpinner-1df67a25.js";/* empty css                                                                       */const ee={class:"w-full"},te=s("div",{class:"flex justify-between my-2"},[s("h6",{class:"mb-3 text-lg font-semibold"},"Documents Approvals")],-1),oe={class:"confirmation-content"},le=s("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),se={class:"confirmation-content"},ne=s("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),ae={class:"confirmation-content"},ie=s("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem"}},null,-1),re={class:"orders-subtable"},ce=["src","alt"],ue=["src","alt"],be={__name:"review_document",setup(de){const w=i(!1);let R=i(),v=i(!1),f=i(!1),k=i(!1),p=i(!1);const E=I(),P=i([]),C=i(),x=i(),J=t=>{w.value=!0,A.post("/view-profile-private-file",{emp_doc_record_id:t}).then(e=>{console.log(e.data.data),x.value=e.data.data,console.log("data sent",x.value)})};i({global:{value:null,matchMode:S.CONTAINS},name:{value:null,matchMode:S.STARTS_WITH,matchMode:S.EQUALS,matchMode:S.CONTAINS},status:{value:"Pending",matchMode:S.EQUALS}}),i(["Pending","Approved","Rejected"]);let a=null,m=null;Q(()=>{R.value=[],D()});function D(){p.value=!0,A.get("/fetch-onboarded-doc").then(t=>{R.value=t.data}).finally(()=>{p.value=!1})}function B(t,e){v.value=!0,a=e,m=t,console.log("Selected Row Data : "+JSON.stringify(t))}function T(t,e){f.value=!0,a=e,m=t,console.log("Selected Bulk Row Data : "+JSON.stringify(t))}function L(t){v.value=!1,t&&g()}function N(t){f.value=!1,t&&g()}function g(){a="",m=null}i();function V(){L(!1),p.value=!0,console.log("Processing Rowdata : "+JSON.stringify(m)),console.log("currentlySelectedStatus : "+a),A.post("/approvals/onboarding-docs-approve-reject",{record_id:m.record_id,status:a=="Approve"?"Approved":a=="Reject"?"Rejected":a,reviewer_comments:""}).then(t=>{console.log(t.data),D(),E.add({severity:"success",summary:"Status",detail:"Processed Successfully !",life:3e3}),g()}).catch(t=>{p.value=!1,g(),console.log(t.toJSON())})}function U(){N(!1),p.value=!0,console.log("Processing Rowdata : "+JSON.stringify(m.documents)),console.log("currentlySelectedStatus : "+a);let t=X(m.documents,"record_id");console.log("Processed doc record ids : "+t),A.post("/approvals/onboarding-bulkdocs-approve-reject",{record_ids:t,status:a=="Approve"?"Approved":a=="Reject"?"Rejected":a,reviewer_comments:""}).then(e=>{console.log(e.data),D(),p.value=!1,g()}).catch(e=>{p.value=!1,g(),console.log(e.toJSON())})}const Y=t=>{switch(t){case"Rejected":return"danger";case"Approved":return"success";case"Pending":return"warning"}};return(t,e)=>{const z=b("Toast"),r=b("Button"),y=b("Dialog"),c=b("Column"),F=b("Tag"),M=b("DataTable");return O(),G(W,null,[l(z),d(p)?(O(),H(Z,{key:0,class:"absolute z-50 bg-white"})):K("",!0),s("div",ee,[te,s("div",null,[l(y,{header:"Confirmation",visible:d(v),"onUpdate:visible":e[2]||(e[2]=o=>j(v)?v.value=o:v=o),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"350px"},modal:!0},{footer:n(()=>[l(r,{label:"Yes",icon:"pi pi-check",onClick:e[0]||(e[0]=o=>V()),class:"p-button-text",autofocus:""}),l(r,{label:"No",icon:"pi pi-times",onClick:e[1]||(e[1]=o=>L(!0)),class:"p-button-text"})]),default:n(()=>[s("div",oe,[le,s("span",null,"Are you sure you want to "+h(d(a))+"?",1)])]),_:1},8,["visible"]),l(y,{header:"Confirmation",visible:d(f),"onUpdate:visible":e[5]||(e[5]=o=>j(f)?f.value=o:f=o),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"580px"},modal:!0},{footer:n(()=>[l(r,{label:"Yes",icon:"pi pi-check",onClick:e[3]||(e[3]=o=>U()),class:"p-button-text",autofocus:""}),l(r,{label:"No",icon:"pi pi-times",onClick:e[4]||(e[4]=o=>N(!0)),class:"p-button-text"})]),default:n(()=>[s("div",se,[ne,s("span",null,"Are you sure you want to "+h(d(a))+" all the documents of this employee?",1)])]),_:1},8,["visible"]),l(y,{header:"Confirmation",visible:d(k),"onUpdate:visible":e[8]||(e[8]=o=>j(k)?k.value=o:k=o),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"580px"},modal:!0},{footer:n(()=>[l(r,{label:"Yes",icon:"pi pi-check",onClick:e[6]||(e[6]=o=>U()),class:"p-button-text",autofocus:""}),l(r,{label:"No",icon:"pi pi-times",onClick:e[7]||(e[7]=o=>N(!0)),class:"p-button-text"})]),default:n(()=>[s("div",ae,[ie,s("span",null,"Are you sure you want to "+h(d(a))+" all the documents of selected employees?",1)])]),_:1},8,["visible"]),s("div",null,[l(M,{value:d(R),paginator:!0,rows:10,class:"",dataKey:"user_code",onRowExpand:t.onRowExpand,onRowCollapse:t.onRowCollapse,expandedRows:P.value,"onUpdate:expandedRows":e[10]||(e[10]=o=>P.value=o),selection:C.value,"onUpdate:selection":e[11]||(e[11]=o=>C.value=o),selectAll:t.selectAll,onSelectAllChange:t.onSelectAllChange,onRowSelect:t.onRowSelect,onRowUnselect:t.onRowUnselect,rowsPerPageOptions:[5,10,25],paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",responsiveLayout:"scroll",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}"},{empty:n(()=>[_(" No Onboarding documents for the selected status filter ")]),loading:n(()=>[_(" Loading employees data. Please wait. ")]),expansion:n(o=>[s("div",re,[l(M,{value:o.data.documents,responsiveLayout:"scroll",selection:C.value,"onUpdate:selection":e[9]||(e[9]=u=>C.value=u),selectAll:t.selectAll,onSelectAllChange:t.onSelectAllChange},{default:n(()=>[l(c,{field:"doc_name",header:"Document Name"}),l(c,{field:"doc_status",header:"Status"},{body:n(({data:u})=>[l(F,{value:u.doc_status,severity:Y(u.doc_status)},null,8,["value","severity"])]),_:1}),l(c,{field:"",header:"View"},{body:n(u=>[l(r,{type:"button",icon:"pi pi-eye",class:"p-button-success Button",label:"View",onClick:$=>J(u.data.record_id),style:{height:"2em"}},null,8,["onClick"])]),_:2},1024),l(c,{field:"",header:"Action"},{body:n(u=>[s("span",null,[l(r,{type:"button",icon:"pi pi-check-circle",class:"p-button-success Button",label:"Approve",onClick:$=>B(u.data,"Approve"),style:{height:"2.5em"}},null,8,["onClick"]),l(r,{type:"button",icon:"pi pi-times-circle",class:"p-button-danger Button",label:"Reject",style:{"margin-left":"8px",height:"2.5em"},onClick:$=>B(u.data,"Reject")},null,8,["onClick"])])]),_:2},1024)]),_:2},1032,["value","selection","selectAll","onSelectAllChange"])])]),default:n(()=>[l(c,{expander:!0}),l(c,{selectionMode:"multiple",style:{width:"1rem"},exportable:!1}),l(c,{field:"user_code",header:"Employee Id",sortable:""}),l(c,{field:"name",header:"Employee Name"}),l(c,{class:"fontSize13px",field:"doj",header:"Date Of Joining"},{body:n(o=>[_(h(d(q)(o.data.doj).format("DD-MMM-YYYY")),1)]),_:1}),l(c,{class:"fontSize13px",field:"doc_status",header:"Approval Status",sortable:!1},{body:n(({data:o})=>[_(h(o.doc_status),1)]),_:1}),l(c,{field:"",header:"Action"},{body:n(o=>[s("span",null,[l(r,{type:"button",icon:"pi pi-check-circle",class:"p-button-success Button",label:"Approve All",onClick:u=>T(o.data,"Approve"),style:{height:"2.5em"}},null,8,["onClick"]),l(r,{type:"button",icon:"pi pi-times-circle",class:"p-button-danger Button",label:"Reject All",style:{"margin-left":"8px",height:"2.5em"},onClick:u=>T(o.data,"Reject")},null,8,["onClick"])])]),_:1})]),_:1},8,["value","onRowExpand","onRowCollapse","expandedRows","selection","selectAll","onSelectAllChange","onRowSelect","onRowUnselect"])]),l(y,{visible:w.value,"onUpdate:visible":e[13]||(e[13]=o=>w.value=o),modal:"",header:"Documents",style:{width:"40vw"}},{default:n(()=>[s("img",{src:`data:image/png;base64,${x.value}`,alt:t.doc_url,class:"block pb-3 m-auto relative"},null,8,ce),s("i",{onClick:e[12]||(e[12]=o=>w.value=!1),class:"pi pi-times border-[3px] p-2 rounded-full border-blue-200 absolute cursor-pointer top-2 right-2"})]),_:1},8,["visible"]),l(y,{visible:t.visible,"onUpdate:visible":e[15]||(e[15]=o=>t.visible=o),modal:"",header:"Documents",style:{width:"40vw"},class:"relative"},{default:n(()=>[s("i",{onClick:e[14]||(e[14]=o=>w.value=!1),class:"pi pi-times border-[3px] p-2 rounded-full border-blue-200 absolute cursor-pointer top-2 right-2"}),s("img",{src:`http://127.0.0.1:8000/${t.doc_url}`,alt:t.doc_url,class:"block pb-3 m-auto"},null,8,ue)]),_:1},8,["visible"])])])],64)}}};export{be as default};
